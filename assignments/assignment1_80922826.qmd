---
title: "Assignment 1"
author: "Eryk Halicki (80922826)"
date: last-modified
format:
  html:
    embed-resources: true
    df-print: tibble
    html-math-method: mathml
execute:
  echo: true
---

```{r, echo=FALSE, warning=FALSE,message=FALSE}
library(tidyverse)
```

```{r}
obesity <- read.csv('/Users/erykhalicki/Documents/School/UBC/year3/DATA311/datasets/ObesityDataSet_raw_and_data_sinthetic.csv')


# Binary columns (yes/no)
obesity[c("family_history_with_overweight", "FAVC", "SMOKE", "SCC")] <- 
  lapply(obesity[c("family_history_with_overweight", "FAVC", "SMOKE", "SCC")], factor)

# Unordered categorical columns
obesity[c("Gender", "MTRANS")] <- 
  lapply(obesity[c("Gender", "MTRANS")], factor)

# Ordered categorical, binning continuous values
obesity$FCVC <- cut(obesity$FCVC, 
                    breaks = c(0, 1.5, 2.5, 3),
                    labels = c("Never", "Sometimes", "Always"),
                    include.lowest = TRUE,
                    ordered_result = TRUE)

obesity$NCP <- cut(obesity$NCP, 
                   breaks = c(0, 1.5, 2.5, 4),
                   labels = c("Between 1 and 2", "Three", "More than three"),
                   include.lowest = TRUE,
                   ordered_result = TRUE)

obesity$CH2O <- cut(obesity$CH2O,
                    breaks = c(0, 1.5, 2.5, 3),
                    labels = c("Less than a liter", "Between 1 and 2 L", "More than 2 L"),
                    include.lowest = TRUE,
                    ordered_result = TRUE)

obesity$FAF <- cut(obesity$FAF,
                   breaks = c(0, 0.5, 1.5, 2.5, 3),
                   labels = c("I do not have", "1 or 2 days", "2 or 4 days", "4 or 5 days"),
                   include.lowest = TRUE,
                   ordered_result = TRUE)

obesity$TUE <- cut(obesity$TUE,
                   breaks = c(0, 1, 1.5, 2),
                   labels = c("0–2 hours", "3–5 hours", "More than 5 hours"),
                   include.lowest = TRUE,
                   ordered_result = TRUE)

# CAEC and CALC are already categorical (text)
obesity$CAEC <- factor(obesity$CAEC,
                       levels = c("no", "Sometimes", "Frequently", "Always"),
                       ordered = TRUE)

obesity$CALC <- factor(obesity$CALC,
                       levels = c("no", "Sometimes", "Frequently", "Always"),
                       ordered = TRUE)

obesity$NObeyesdad <- factor(obesity$NObeyesdad,
                             levels = c("Insufficient_Weight", "Normal_Weight",
                                       "Overweight_Level_I", "Overweight_Level_II",
                                       "Obesity_Type_I", "Obesity_Type_II",
                                       "Obesity_Type_III"),
                             ordered = TRUE)
var_info <- data.frame(
  Variable = colnames(obesity),
  Type = sapply(obesity, function(x) class(x)[1]), # rename
  Description = c(
    "The gender of the participant",
    "Age of participant (years)",
    "Height (m)",
    "Weight (kg)",
    "Has a family member suffered or suffers from overweight?",
    "Do you eat high caloric food frequently?",
    "Do you usually eat vegetables in your meals?",
    "How many main meals do you have daily?",
    "Do you eat any food between meals?",
    "Do you smoke?",
    "How much water do you drink daily?",
    "Do you monitor the calories you eat daily?",
    "How often do you have physical activity?",
    "How much time do you use technological devices such as cell phone, videogames, television, computer and others? (Hours per week)",
    "How often do you drink alcohol?",
    "Which transportation do you usually use?",
    "Obesity level"
  )
)
```

This dataset contains data used to estimate the obesity levels in individuals from Mexico, Peru, and Columbia. The data is 77% synthetic and 23% was collected directly from users through a web platform. The dataset is sourced from https://archive.ics.uci.edu/dataset/544/estimation+of+obesity+levels+based+on+eating+habits+and+physical+condition, and has `{r} nrow(obesity)` rows and `{r} ncol(obesity)` variables. More detailed versions of the variable desciptions are available at https://doi.org/10.1016/j.dib.2019.104344.
```{r} 
var_info

obesity
```

There are `r sum(is.na(obesity))` rows with missing values, nothing needs to be removed.

There are also `r sum(duplicated(obesity))` duplicated rows, but I dont believe we should remove them. Since there are no uniquely identifying features in the dataset (like name or a participant ID), it is entirely possible for the duplicates to be different individuals with the same responses. If we were to remove them, we could be skewing the data away from what was actually collected. 

```{r}
#| label: fig-scatter
#| fig-cap: "BMI vs Age scatterplot"
obesity$BMI <- obesity$Weight / (obesity$Height*obesity$Height)

plot(obesity$Age, obesity$BMI, xlab = 'Age', ylab = 'BMI', main = 'BMI vs Age')
```

As can be seen in @fig-scatter, the relationship between BMI and Age in the obesity dataset seems to be weakly positive, however there is a lot of variability in the data, especially at lower ages (~18-25).

I do not beleive that a linear model is appropriate for capturing the relationship between Age and BMI. Firstly, the data does not appear linearly correlated, since the weak positive relationship appears to become negative after age ~40. Furthermore, the data does not appear homoscedastic, since it becomes much tighter as Age increases (I.E. Funnel shaped).

```{r}
#| label: fig-boxplots
#| fig-cap: 
#|   - "BMI by Family History of Overweight"
#|   - "BMI by High Caloric Food Consumption"
#|   - "BMI by Smoking Status"
#|   - "BMI by Calorie Monitoring"
#|   - "BMI by Transportation Method"
#|   - "BMI by Obesity Level"
#|   - "BMI by Vegetable Consumption"
#|   - "BMI by Number of Main Meals"
#|   - "BMI by Eating Between Meals"
#|   - "BMI by Water Consumption"
#|   - "BMI by Physical Activity Frequency"
#|   - "BMI by Technology Use"
#|   - "BMI by Alcohol Consumption"

#unordered
boxplot(BMI ~ family_history_with_overweight, data = obesity)
boxplot(BMI ~ FAVC, data = obesity)
boxplot(BMI ~ SMOKE, data = obesity)
boxplot(BMI ~ SCC, data = obesity)
boxplot(BMI ~ MTRANS, data = obesity, cex.axis=0.8)
boxplot(BMI ~ NObeyesdad, data = obesity, cex.axis=0.45)

#ordered
boxplot(BMI ~ FCVC, data=obesity)
boxplot(BMI ~ NCP, data=obesity)
boxplot(BMI ~ CAEC, data=obesity)
boxplot(BMI ~ CH2O, data=obesity)
boxplot(BMI ~ FAF, data=obesity)
boxplot(BMI ~ TUE, data=obesity)
boxplot(BMI ~ CALC, data=obesity)
```

Although many of the boxplots show a relationship between BMI and their repsective category, BMI and family history of overweightness stands out to me. As can be seen in @fig-boxplots-1, there is a large difference between the mean of the two categories; participants without a family history of overweightness had a mean BMI of ~21, whereas participants with a family history of overweightness had a mean ~32. Furthermore, the 25th percentile of the "yes" category is higher than the 75th percetile of the "no" category. As such, I believe family history of overweightness is predictive of BMI, with respondants in the "yes" category having higher BMI's than those in the "no" category.

```{r}
set.seed(80922826)

train_indices <- sample(1:nrow(obesity), size= 0.7*nrow(obesity))

training_set <- obesity[train_indices, ]
testing_set <- obesity[-train_indices, ]
```

The training and testing sets have `r nrow(training_set)` and `r nrow(testing_set)` rows, respectively.







